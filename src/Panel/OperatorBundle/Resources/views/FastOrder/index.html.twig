{% extends 'PanelOperatorBundle::layout.html.twig' %}

{% block breadcrumb %}{% endblock %}

{% block content %}
    <h1>Быстрые заказы</h1>
    <table class="table">
        <tr>
            <th>№</th>
            <th>Тег</th>
            <th>Дата</th>
            <th>Тип</th>
            <th>Цена</th>
            <th>ФИО</th>
            <th>Статус</th>
            <th class="setting"></th>
        </tr>
        {% for o in orders %}
            <tr>
                <td>{{ o.id }}</td>
                <td>
                    <input type="text" style="width: 50px; text-align: center" value="{{ o.managerKey }}" class="managers3" id="{{ o.id }}">
                </td>
                <td>{{ o.created | date("d.m.Y") }}</td>
                <td>{{ o.cardType }}</td>
                <td>{{ o.price }}</td>
                <td>{{ o.fio }}</td>
                <td>{{ o.statusStr }}</td>
                <td class="setting">
                    {% if o.cardType == 'СКЗИ' %}
                        <a href="{{ path('application-skzi-add',{'fid' : o.id }) }}" class="btn btn-primary" target="_blank"><span class="glyphicon glyphicon-send"></span></a>
                    {% elseif o.cardType == 'ЕСТР' %}
                        <a href="{{ path('application-estr-add',{'fid' : o.id }) }}" class="btn btn-primary" target="_blank"><span class="glyphicon glyphicon-send"></span></a>
                    {% elseif o.cardType == 'РФ' %}
                        <a href="{{ path('application-ru-add',{'fid' : o.id }) }}" class="btn btn-primary" target="_blank"><span class="glyphicon glyphicon-send"></span></a>
                    {% endif %}
                    <a href="{{ path('get_images',{'id' : o.id }) }}" class="btn btn-success"><span class="glyphicon glyphicon-send"></span></a>
                    <a href="{{ path('panel_fastOrder_edit',{'id' : o.id }) }}" class="btn btn-primary"><span class="glyphicon glyphicon-edit"></span></a>
                    <a href="#" class="btn btn-danger"><span class="glyphicon glyphicon-remove"></span></a>
                </td>
            </tr>
        {% endfor %}
    </table>
{% endblock %}

{% block javascripts %}
    {{ parent() }}
    <script>
        $(document).ready(function () {
            $('.managers3').keypress(function(e){
                var input = $(this);
                $(input).css('color','rgb(0, 0, 0)');
                if(e.which == 13) {
                    $.ajax({
                        type: "POST",
                        url: Routing.generate('panel_edit_fast_manager'),
                        data: 'id='+$(input).attr('id')+'&key='+$(input).val(),
                        success: function (msg) {
                            if (msg == 'ok'){
                                $(input).css('color','rgb(46, 124, 55)');
                            }else{
                                alert('Ошибка сохраненния');
                                $(input).css('color','rgb(124, 46, 55)');
                            }
                        }
                    });
                }
            });
        })
    </script>
{% endblock %}